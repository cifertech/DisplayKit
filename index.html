<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DisplayKit - TFT_eSPI + U8g2 UI Builder</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-shell">
  <div class="sidebar">
    <div class="sidebar-header">
      <div style="flex: 1;">
        <h2>DisplayKit</h2>
        <div class="brand-subtitle">by CiferTech</div>
      </div>
    </div>

    <div class="sidebar-card highlight">
      <div class="sidebar-card-title">Project Links</div>
      <a class="link-chip" href="https://github.com/cifertech/DisplayKit" target="_blank" rel="noreferrer">
        <span class="icon">‚Üó</span> GitHub Repo
      </a>
      <a class="link-chip" href="https://www.patreon.com/cifertech" target="_blank" rel="noreferrer">
        <span class="icon">‚ù§Ô∏è</span> Support on Patreon
      </a>
    </div>

    <div class="sidebar-card tools-card">
      <div class="sidebar-card-title">Tools</div>
      <a class="link-chip" href="tools/pixelforge/index.html" data-open-tool="pixelforge" rel="noreferrer">
        <span class="icon">üß©</span> PixelForge (Image Converter)
      </a>
      <a class="link-chip" href="tools/bitcanvas-studio/index.html" data-open-tool="bitcanvas" rel="noreferrer">
        <span class="icon">üéûÔ∏è</span> BitCanvas Studio (Animation)
      </a>
    </div>

    <div class="sidebar-card note section-card">
      <div class="sidebar-card-title">Workflow tips</div>
      <ul>
        <li>Use Snap-to-grid for pixel-perfect layouts.</li>
        <li>Duplicate elements to iterate fast.</li>
        <li>Export JSON often for versioning.</li>
      </ul>
    </div>

    <div class="section-title">Display</div>
    <div class="prop-group">
      <div class="prop-row">
        <div>
          <label for="dispWidth">Width</label>
          <input type="number" id="dispWidth" value="240" min="1" />
        </div>
        <div>
          <label for="dispHeight">Height</label>
          <input type="number" id="dispHeight" value="320" min="1" />
        </div>
      </div>
      <div class="prop-row">
        <div>
          <label for="displayDriver">Driver</label>
          <select id="displayDriver">
            <option value="tft">TFT_eSPI</option>
            <option value="u8g2">U8g2 OLED</option>
          </select>
        </div>
      </div>
      <button class="btn small secondary icon-btn-ghost" id="applyRes" title="Apply resolution">
        <span>Apply</span>
      </button>
    </div>

    <!-- TFT Display Settings -->
    <div id="tftSettings" class="display-settings">
      <div class="section-title">TFT Display Settings</div>
      <div class="prop-group">
        <div class="prop-row">
          <div>
            <label for="tftRotation">Rotation</label>
            <select id="tftRotation">
              <option value="0">0¬∞ (Portrait)</option>
              <option value="1">90¬∞ (Landscape)</option>
              <option value="2">180¬∞ (Portrait)</option>
              <option value="3">270¬∞ (Landscape)</option>
            </select>
          </div>
          <div>
            <label for="tftColorDepth">Color Depth</label>
            <select id="tftColorDepth">
              <option value="16">16-bit RGB565</option>
              <option value="18">18-bit RGB666</option>
              <option value="24">24-bit RGB888</option>
            </select>
          </div>
        </div>
        <div class="prop-row">
          <div>
            <label for="tftBacklight">Backlight Control</label>
            <select id="tftBacklight">
              <option value="none">None</option>
              <option value="pwm">PWM Pin</option>
              <option value="manual">Manual</option>
            </select>
          </div>
          <div>
            <label for="tftTouch">Touch Support</label>
            <select id="tftTouch">
              <option value="none">No Touch</option>
              <option value="resistive">Resistive</option>
              <option value="capacitive">Capacitive</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- OLED Display Settings -->
    <div id="oledSettings" class="display-settings">
      <div class="section-title">OLED Display Settings</div>
      <div class="prop-group">
        <div class="prop-row">
          <div>
            <label for="u8g2Preset">U8g2 Display Model</label>
            <select id="u8g2Preset">

            </select>
          </div>
          <div>
            <label for="oledRotation">Rotation</label>
            <select id="oledRotation">
              <option value="0">0¬∞ (Normal)</option>
              <option value="1">90¬∞ (Clockwise)</option>
              <option value="2">180¬∞ (Upside Down)</option>
              <option value="3">270¬∞ (Counter-clockwise)</option>
            </select>
          </div>
        </div>
        <div class="prop-row">
          <div>
            <label for="oledContrast">Contrast (0-255)</label>
            <input type="range" id="oledContrast" min="0" max="255" value="127" />
            <span id="oledContrastValue">127</span>
          </div>
          <div>
            <label for="oledFlipMode">Flip Mode</label>
            <select id="oledFlipMode">
              <option value="none">Normal</option>
              <option value="horizontal">Horizontal Flip</option>
              <option value="vertical">Vertical Flip</option>
              <option value="both">Both</option>
            </select>
          </div>
        </div>
        <div class="prop-row">
          <div>
            <label for="oledFontMode">Font Rendering</label>
            <select id="oledFontMode">
              <option value="transparent">Transparent Background</option>
              <option value="solid">Solid Background</option>
              <option value="inverse">Inverse Colors</option>
            </select>
          </div>
          <div>
            <label for="oledPowerSave">Power Save Mode</label>
            <select id="oledPowerSave">
              <option value="off">Always On</option>
              <option value="auto">Auto Sleep</option>
              <option value="manual">Manual Control</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="section-title">Screens</div>
    <div class="prop-group">
      <label for="screenSelect">Current screen</label>
      <div class="prop-row">
        <div>
          <select id="screenSelect"></select>
        </div>
        <button class="btn small secondary icon-btn-ghost" id="addScreenBtn" title="Add screen">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <line x1="12" y1="6" x2="12" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            <line x1="6" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>

    <div class="prop-group">
      <label for="screenFnName">Function name</label>
      <div class="prop-row fn-row">
        <div>
          <input type="text" id="screenFnName" placeholder="drawHomeScreen" />
        </div>
        <button class="btn small secondary icon-btn-ghost" id="deleteScreenBtn" title="Delete screen">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <polyline points="9,6 10,4 14,4 15,6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
            <rect x="7" y="6" width="10" height="12" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
            <line x1="10" y1="10" x2="10" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            <line x1="14" y1="10" x2="14" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>

    <div class="sidebar-card section-card">
      <div class="sidebar-card-title">Basic Shapes</div>
      <div class="btn-group">
        <button class="btn small chip-btn" data-add="rect" title="Rect">
          <span class="icon-box shape">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="7" width="14" height="10" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </span>
          <span class="chip-label">Rect</span>
        </button>
        <button class="btn small chip-btn" data-add="roundrect" title="Round Rect">
          <span class="icon-box shape">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="7" width="14" height="10" rx="5" ry="5" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </span>
          <span class="chip-label">Round</span>
        </button>
        <button class="btn small chip-btn" data-add="circle" title="Circle">
          <span class="icon-box shape">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </span>
          <span class="chip-label">Circle</span>
        </button>
        <button class="btn small chip-btn" data-add="line" title="Line">
          <span class="icon-box shape">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <line x1="5" y1="18" x2="19" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
          <span class="chip-label">Line</span>
        </button>
        <button class="btn small chip-btn" data-add="divider" title="Divider">
          <span class="icon-box shape">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
          <span class="chip-label">Divider</span>
        </button>
      </div>
    </div>

    <div class="sidebar-card section-card">
      <div class="sidebar-card-title">UI Elements</div>
      <div class="btn-group">
        <button class="btn small chip-btn" data-add="label" title="Label">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="7" width="14" height="10" rx="3" ry="3" stroke="currentColor" stroke-width="2" fill="none" />
              <line x1="8" y1="11" x2="16" y2="11" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
          <span class="chip-label">Label</span>
        </button>
        <button class="btn small chip-btn" data-add="button" title="Button">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="6" y="9" width="12" height="6" rx="3" ry="3" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </span>
          <span class="chip-label">Button</span>
        </button>
        <button class="btn small chip-btn" data-add="progress" title="Progress">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="10" width="14" height="4" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
              <rect x="6" y="11" width="7" height="2" rx="1" ry="1" fill="currentColor" />
            </svg>
          </span>
          <span class="chip-label">Progress</span>
        </button>
        <button class="btn small chip-btn" data-add="slider" title="Slider">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <line x1="6" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              <circle cx="10" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="var(--bg-tertiary)" />
            </svg>
          </span>
          <span class="chip-label">Slider</span>
        </button>
        <button class="btn small chip-btn" data-add="toggle" title="Toggle">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="9" width="14" height="6" rx="3" ry="3" stroke="currentColor" stroke-width="2" fill="none" />
              <circle cx="15" cy="12" r="2.5" stroke="currentColor" stroke-width="2" fill="var(--bg-tertiary)" />
            </svg>
          </span>
          <span class="chip-label">Toggle</span>
        </button>
        <button class="btn small chip-btn" data-add="card" title="Card">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="7" width="14" height="10" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
              <line x1="7" y1="11" x2="17" y2="11" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
          <span class="chip-label">Card</span>
        </button>
        <button class="btn small chip-btn" data-add="header" title="Header">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="5" y="7" width="14" height="4" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </span>
          <span class="chip-label">Header</span>
        </button>
        <button class="btn small chip-btn" id="addImageBtn" title="Image">
          <span class="icon-box ui">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <rect x="4" y="6" width="16" height="12" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
              <circle cx="10" cy="11" r="1.5" stroke="currentColor" stroke-width="1.5" fill="none" />
              <polyline points="7,16 11,12 16,16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </span>
          <span class="chip-label">Image</span>
        </button>
      </div>
    </div>

      <div class="section-title">
        Scene
        <span style="font-size: 10px; font-weight: normal; opacity: 0.7; margin-left: 8px;">
          Tab: cycle elements ‚Ä¢ Ctrl+D: duplicate ‚Ä¢ Arrows: move ‚Ä¢ Ctrl+1-6: align
        </span>
      </div>
    <div class="sidebar-card section-card">
      <div class="sidebar-card-title">Background</div>
      <div class="bg-color-row">
        <div class="bg-presets">
          <button class="bg-chip" data-bg-color="#000000">
            <span class="bg-chip-swatch" style="background:#000000"></span>
            <span>Black</span>
          </button>
          <button class="bg-chip" data-bg-color="#ffffff">
            <span class="bg-chip-swatch" style="background:#ffffff"></span>
            <span>White</span>
          </button>
          <button class="bg-chip" data-bg-color="#111827">
            <span class="bg-chip-swatch" style="background:#111827"></span>
            <span>Dark gray</span>
          </button>
          <button class="bg-chip" data-bg-color="#e5e7eb">
            <span class="bg-chip-swatch" style="background:#e5e7eb"></span>
            <span>Light gray</span>
          </button>
          <button class="bg-chip bg-chip-custom" id="bgColorCustom">
            <span class="bg-chip-swatch" style="background:conic-gradient(red, orange, yellow, green, cyan, blue, magenta, red)"></span>
            <span>Custom</span>
          </button>
        </div>
      </div>
      <input type="color" id="bgColor" value="#000000" style="display:none" />
    </div>

    <div class="section-title">Grid & Snap</div>
    <div class="prop-group">
      <label class="toggle-label">
        <input type="checkbox" id="snapCheckbox" class="toggle-input" />
        Snap to grid
      </label>
      <div class="prop-row">
        <div>
          <label for="gridSize">Grid size (px)</label>
          <input type="number" id="gridSize" value="4" min="1" />
        </div>
      </div>
    </div>

    <div class="prop-group">
      <label class="toggle-label">
        <input type="checkbox" id="useSpriteCheckbox" class="toggle-input" />
        Use sprite (TFT_eSprite) for screens
      </label>
    </div>

    <div class="prop-group">
      <button class="btn secondary small" id="clearAll">Clear all (screen)</button>
    </div>
  </div>

  <div class="main">
    <div class="top-bar">
      <div class="top-left">
        <div class="top-left-primary">
          <span id="displayInfo">TFT_eSPI ¬∑ 240x320 px</span>
          <span class="pill">Multi-screen ¬∑ Drag to position ¬∑ Click to edit</span>
        </div>
        <div class="status-chips">
          <span class="pill soft">Drag to move</span>
          <span class="pill soft">‚åò / Ctrl + Z to undo</span>
          <span class="pill soft">Export JSON for versioning</span>
        </div>
      </div>
      <div class="top-right">
        <a class="btn small github" href="https://github.com/cifertech/DisplayKit" target="_blank" rel="noreferrer">
          GitHub
        </a>
        <a class="btn small patreon" href="https://www.patreon.com/cifertech" target="_blank" rel="noreferrer">
          Patreon
        </a>
        <button class="btn small secondary" id="themeToggle" title="Toggle theme">
          <span id="themeIcon">üåô</span>
        </button>
        <button class="btn small secondary" id="undoBtn">Undo</button>
        <button class="btn small secondary" id="redoBtn">Redo</button>
        <button class="btn small secondary" id="duplicateBtn">Duplicate</button>
        <div class="slider-inline">
          <span>Zoom</span>
          <input type="range" id="zoomSlider" min="50" max="200" value="75" />
        </div>
        <button class="btn small secondary" id="exportJsonBtn">Export JSON</button>
        <button class="btn small secondary" id="importJsonBtn">Import JSON</button>
      </div>
    </div>
    <div class="workspace">
      <div class="preview-wrapper">
        <div class="preview-frame">
          <div id="preview"></div>
        </div>
      </div>
      <div class="properties">
        <div class="section-title">Selected Element</div>
        <div id="noSelection">No element selected</div>
        <div id="propsPanel" style="display: none">
          <div class="prop-group">
            <label id="propTypeLabel">Type</label>
            <div class="pill" id="elementTypePill"></div>
          </div>

          <div class="prop-group">
            <div class="prop-row">
              <div>
                <label for="propX">X</label>
                <input type="number" id="propX" />
              </div>
              <div>
                <label for="propY">Y</label>
                <input type="number" id="propY" />
              </div>
            </div>
            <div class="prop-row">
              <div>
                <label for="propW">W</label>
                <input type="number" id="propW" />
              </div>
              <div>
                <label for="propH">H</label>
                <input type="number" id="propH" />
              </div>
            </div>
          </div>

          <div class="prop-group" id="textGroup">
            <label for="propText">Text</label>
            <input type="text" id="propText" />
            <div class="prop-row">
              <div>
                <label for="propTextSize">Text size (TFT)</label>
                <input type="number" id="propTextSize" min="1" max="10" />
              </div>
            </div>
          </div>

          <div class="prop-group" id="fontGroup">
            <label for="propFont">Font (U8g2)</label>
            <select id="propFont"></select>
          </div>

          <div class="prop-group" id="valueGroup" style="display: none">
            <label for="propValue">Value / Level (0‚Äì100)</label>
            <input type="number" id="propValue" min="0" max="100" />
          </div>

          <div class="prop-group">
            <label>Colors</label>
            <div class="prop-row color-row">
              <div class="pill">
                <input type="color" id="propFillColor" />
                <span>Fill</span>
              </div>
              <div class="pill">
                <input type="color" id="propStrokeColor" />
                <span>Stroke</span>
              </div>
              <div class="pill">
                <input type="color" id="propTextColor" />
                <span>Text</span>
              </div>
            </div>
            <div class="prop-row" id="fillTransparencyRow">
              <div>
                <label for="propFillAlpha">Fill Transparency</label>
                <input type="range" id="propFillAlpha" min="0" max="255" value="255" />
                <span id="fillAlphaValue">100%</span>
              </div>
            </div>
            <div class="prop-row" id="oledFillRow" style="display: none;">
              <div class="fill-control">
                <input type="checkbox" id="propOLEDFill" checked />
                <label for="propOLEDFill" class="fill-label">
                  <span class="fill-indicator"></span>
                  Filled
                </label>
              </div>
            </div>
          </div>

          <div class="prop-group" id="actionGroup" style="display:none;">
            <label for="propAction">On click</label>
            <select id="propAction">
              <option value="">None</option>
              <option value="goto">Go to screen‚Ä¶</option>
            </select>
            <div class="prop-row">
              <div>
                <label for="propActionTarget">Target screen</label>
                <select id="propActionTarget"></select>
              </div>
            </div>
          </div>

          <div class="prop-group">
            <label>Align to screen</label>
            <div class="btn-group">
              <button class="btn small secondary" id="alignLeftBtn">Left</button>
              <button class="btn small secondary" id="alignHCenterBtn">H-Center</button>
              <button class="btn small secondary" id="alignRightBtn">Right</button>
              <button class="btn small secondary" id="alignTopBtn">Top</button>
              <button class="btn small secondary" id="alignVCenterBtn">V-Center</button>
              <button class="btn small secondary" id="alignBottomBtn">Bottom</button>
            </div>
          </div>

          <div class="prop-group" style="display: flex; justify-content: flex-end;">
            <button class="btn danger small" id="deleteElement" title="Delete element">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <polyline points="9,6 10,4 14,4 15,6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
                <rect x="7" y="6" width="10" height="12" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
                <line x1="10" y1="10" x2="10" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                <line x1="14" y1="10" x2="14" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
              <span>Delete</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="code-panel">
      <div style="display: flex; justify-content: space-between; align-items: center">
        <div class="section-title">Generated Code (TFT_eSPI / U8g2)</div>
        <div>
          <button class="btn small secondary" id="copyCode">
            <svg viewBox="0 0 24 24" aria-hidden="true" style="width:14px;height:14px;margin-right:4px">
              <rect x="9" y="9" width="11" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
              <rect x="4" y="4" width="11" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
            <span>Copy</span>
          </button>
        </div>
      </div>
      <textarea id="codeOutput" spellcheck="false"></textarea>
    </div>
  </div>

</div>

  
  <input type="file" id="imageInput" accept="image/*" style="display: none" />
  <input type="file" id="importJsonInput" accept="application/json" style="display:none" />

  <!-- In-app tools overlay (PixelForge / BitCanvas Studio) -->
  <div class="tool-overlay" id="toolOverlay" aria-hidden="true">
    <div class="tool-overlay-inner" role="dialog" aria-modal="true" aria-label="Tools">
      <div class="tool-overlay-bar">
        <div class="tool-overlay-title">
          <span class="pill outline" id="toolOverlayPill">Tools</span>
          <div class="tool-switcher" role="tablist" aria-label="Tools switcher">
            <button class="tool-switch-btn" type="button" data-switch-tool="pixelforge" role="tab" aria-selected="false">
              üß© PixelForge
            </button>
            <button class="tool-switch-btn" type="button" data-switch-tool="bitcanvas" role="tab" aria-selected="false">
              üéûÔ∏è BitCanvas
            </button>
          </div>
        </div>
        <div class="tool-overlay-actions">
          <button class="btn small success" id="toolOverlayAction" type="button" style="display:none">Action</button>
          <a class="btn small secondary" id="toolOverlayOpenNewTab" href="#" target="_blank" rel="noreferrer">Open in new tab</a>
          <button class="btn small" id="toolOverlayClose" type="button">Back to DisplayKit</button>
        </div>
      </div>
      <div class="tool-overlay-frames">
        <iframe
          id="toolFrame_pixelforge"
          class="tool-overlay-frame"
          title="PixelForge"
          src="about:blank"
          allow="clipboard-read; clipboard-write"
        ></iframe>
        <iframe
          id="toolFrame_bitcanvas"
          class="tool-overlay-frame"
          title="BitCanvas Studio"
          src="about:blank"
          allow="clipboard-read; clipboard-write"
        ></iframe>
      </div>
    </div>
  </div>
  <script src="app.js"></script>
</body>
</html>




